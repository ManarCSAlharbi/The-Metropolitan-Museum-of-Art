<ion-card *ngIf="artwork && artwork.objectID">
  <img [src]="artwork.primaryImageSmall || artwork.primaryImage" 
       alt="Artwork" 
       onerror="this.src='assets/icon/favicon.png'" />

  <ion-card-header>
    <ion-card-title>{{ artwork.title || 'Untitled' }}</ion-card-title>
    <ion-card-subtitle>{{ artwork.artistDisplayName || 'Unknown Artist' }}</ion-card-subtitle>
    
    <!-- Likes Section -->
    <div class="likes-section">
      <ion-button 
        fill="clear" 
        size="small" 
        (click)="toggleLike()"
        class="like-button"
        [class.liked-state]="isLiked"
        *ngIf="!showRemoveButton">
        <ion-icon 
          slot="icon-only" 
          [name]="isLiked ? 'heart' : 'heart-outline'"
          class="like-icon"
          [class.is-liked]="isLiked">
        </ion-icon>
      </ion-button>
      
      <!-- Remove button for Tab3 -->
      <ion-button 
        fill="clear" 
        size="small" 
        (click)="removeFromLiked()"
        class="remove-button"
        *ngIf="showRemoveButton"
        title="Click to remove from liked artworks">
        <ion-icon 
          slot="icon-only" 
          name="heart"
          class="remove-icon">
        </ion-icon>
      </ion-button>
      
      <span class="likes-count">{{ likes }}</span>
    </div>
  </ion-card-header>

  <ion-button 

    class="show-more-button"
    expand="block"
    (click)="openModal()"
    color="teal"
    >
    Show More Info
  </ion-button>

  <ion-modal
    #artModal
    (ionDidOpen)="loadComments()"
    [canDismiss]="true">
    <ng-template>
      <ion-header>
        <ion-toolbar class="modal.toolbar">
          <ion-title class="title.modal" slot="start">{{ artwork.title || 'Untitled' }}</ion-title>
          <ion-buttons slot="end" >
            <ion-button fill="clear" (click)="dismissModal($event)">
              <ion-icon slot="icon-only" name="close" style="color: gray;"></ion-icon>
            </ion-button>
          </ion-buttons>
        </ion-toolbar>
      </ion-header>

      <ion-content class="ion-padding">
        <img [src]="artwork?.primaryImageSmall || artwork?.primaryImage" 
             alt="Artwork"
             onerror="this.src='assets/icon/favicon.png'" />
        <h2><strong>{{ artwork?.title || 'Untitled' }}</strong></h2>
        <h3 class="h3">{{ artwork?.artistDisplayName || 'Unknown Artist' }}</h3>
        <p><strong>Dimensions:</strong> {{ artwork?.dimensions || 'Not specified' }}</p>
        <p><strong>Date:</strong> {{ artwork?.objectDate || 'Unknown date' }}</p>

        <h3>Add Comment</h3>
        <ion-input 
          label="Name" 
          label-placement="floating" 
          fill="outline"
          placeholder="Enter Your Name"
          [(ngModel)]="newComment.username"
          (ionInput)="onUserStartsTyping()"
          maxlength="50"
          required>
        </ion-input>
        <div class="error-message" *ngIf="!validation.username.isValid && newComment.username.length > 0 && !justSubmitted">
          {{ validation.username.errorMessage }}
        </div>

        <ion-textarea 
          label="Comment" 
          label-placement="floating" 
          placeholder="What Do You Think?" 
          autoGrow="true"
          [(ngModel)]="newComment.comment"
          (ionInput)="onUserStartsTyping()"
          maxlength="500"
          rows="3"
          required>
        </ion-textarea>
        <div class="error-message" *ngIf="!validation.comment.isValid && newComment.comment.length > 0 && !justSubmitted">
          {{ validation.comment.errorMessage }}
        </div>

        <ion-button 
          class="comment-submit-button"
          expand="block"
          (click)="addComment()"
          [disabled]="!newComment.username.trim() || !newComment.comment.trim()"
          color="teal">
          Comment
        </ion-button>

        <h3>Comments ({{ comments.length }})</h3>
        <ion-list>
          <ion-item *ngFor="let comment of comments">
            <ion-label>
              <h3>{{ comment.username }}</h3>
              <p>{{ comment.comment }}</p>
              <p class="comment-date">{{ comment.creation_date | date:'short' }}</p>
            </ion-label>
          </ion-item>
          <ion-item *ngIf="comments.length === 0">
            <ion-label>
              <p>No comments yet. Be the first to comment!</p>
            </ion-label>
          </ion-item>
        </ion-list>
      </ion-content>
    </ng-template>
  </ion-modal>
</ion-card>